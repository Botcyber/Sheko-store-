<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>لوحة تحكم الأدمن</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Cairo', sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
    .container { max-width: 800px; margin: 30px auto; background: #fff; padding: 20px; border-radius: 10px; }
    h2 { text-align: center; color: #222; }
    label, input, textarea, button, select { width: 100%; margin: 10px 0; padding: 10px; font-size: 16px; }
    button { background: #333; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #555; }
    .section { margin-top: 30px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>لوحة تحكم الأدمن</h2><div class="section">
  <h3>تعديل رصيد المستخدم</h3>
  <label>UID المستخدم</label>
  <input type="text" id="uid">
  <label>المبلغ</label>
  <input type="number" id="amount">
  <select id="action">
    <option value="add">إضافة رصيد</option>
    <option value="remove">خصم رصيد</option>
  </select>
  <button onclick="updateBalance()">تنفيذ</button>
</div>

<div class="section">
  <h3>الطلبات</h3>
  <ul id="orders"></ul>
</div>

<div class="section">
  <h3>طلبات تحويل الأموال</h3>
  <ul id="payments"></ul>
</div>

  </div>  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAYcZ2_RjaI4fjP14QlqbUbL3rWvPPWnas",
      authDomain: "sheko-store.firebaseapp.com",
      databaseURL: "https://sheko-store-default-rtdb.firebaseio.com",
      projectId: "sheko-store",
      storageBucket: "sheko-store.appspot.com",
      messagingSenderId: "113892775847",
      appId: "1:113892775847:web:2aa4c11c3f5dd1d15f0882"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function updateBalance() {
      const uid = document.getElementById('uid').value;
      const amount = parseFloat(document.getElementById('amount').value);
      const action = document.getElementById('action').value;

      if (!uid || isNaN(amount)) return alert("يرجى إدخال UID والمبلغ");

      const userRef = db.ref("users/" + uid);
      userRef.once('value').then(snapshot => {
        if (!snapshot.exists()) return alert("المستخدم غير موجود");
        const userData = snapshot.val();
        let newBalance = userData.balance || 0;
        if (action === "add") newBalance += amount;
        else newBalance -= amount;

        userRef.update({ balance: newBalance });
        alert("تم تحديث الرصيد بنجاح");
      }).catch(err => alert("فشل التحديث"));
    }

    function loadOrders() {
      const ordersList = document.getElementById('orders');
      db.ref("orders").on('value', snapshot => {
        ordersList.innerHTML = "";
        snapshot.forEach(orderSnap => {
          const data = orderSnap.val();
          const li = document.createElement("li");
          li.textContent = `طلب من ${data.account} | ${data.service} - ${data.package} | الحالة: ${data.status}`;
          ordersList.appendChild(li);
        });
      });
    }

    function loadPayments() {
      const paymentsList = document.getElementById('payments');
      db.ref("payments").on('value', snapshot => {
        paymentsList.innerHTML = "";
        snapshot.forEach(paymentSnap => {
          const data = paymentSnap.val();
          const li = document.createElement("li");
          li.textContent = `من: ${data.from} | المبلغ: ${data.amount}`;
          paymentsList.appendChild(li);
        });
      });
    }

    loadOrders();
    loadPayments();
  </script></body>
</html>
