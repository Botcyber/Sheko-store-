<!DOCTYPE html><html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± - Sheko Store</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #28a745;
      color: white;
      cursor: pointer;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #007bff;
      color: white;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAYcZ2_RjaI4fjP14QlqbUbL3rWvPPWnas",
      authDomain: "sheko-store.firebaseapp.com",
      projectId: "sheko-store",
      storageBucket: "sheko-store.firebasestorage.app",
      messagingSenderId: "113892775847",
      appId: "1:113892775847:web:2aa4c11c3f5dd1d15f0882"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();// Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„ - ÙÙ‚Ø· Ù„Ù„Ù…Ø¯ÙŠØ±
auth.onAuthStateChanged(user => {
  if (user) {
    db.ref("adminUsers/" + user.uid).once("value").then(snap => {
      if (!snap.exists()) {
        alert("ğŸš« Ø¯Ø®ÙˆÙ„ ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ù‡");
        window.location.href = "index.html";
      } else {
        loadOrders();
      }
    });
  } else {
    window.location.href = "index.html";
  }
});

function addBalancePoints() {
  const uid = document.getElementById("uid").value;
  const balance = parseInt(document.getElementById("balance").value);
  const points = parseInt(document.getElementById("points").value);
  if (uid && !isNaN(balance)) db.ref("balance/" + uid).set(balance);
  if (uid && !isNaN(points)) db.ref("points/" + uid).set(points);
  alert("âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­");
}

function loadOrders() {
  db.ref("orders").once("value").then(snapshot => {
    const ordersTable = document.getElementById("ordersBody");
    ordersTable.innerHTML = "";
    snapshot.forEach(userSnap => {
      const uid = userSnap.key;
      userSnap.forEach(orderSnap => {
        const orderId = orderSnap.key;
        const data = orderSnap.val();
        const status = data.status || "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±";
        const row = `
          <tr>
            <td>${uid}</td>
            <td>${data.mainService} - ${data.subService}</td>
            <td>${data.account}</td>
            <td>${data.phone}</td>
            <td>${data.date}</td>
            <td>
              <select onchange="updateStatus('${uid}', '${orderId}', this.value)">
                <option ${status === "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°" ? "selected" : ""}>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                <option ${status === "ØªÙ…" ? "selected" : ""}>ØªÙ…</option>
                <option ${status === "ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡" ? "selected" : ""}>ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡</option>
              </select>
            </td>
          </tr>
        `;
        ordersTable.innerHTML += row;
      });
    });
  });
}

function updateStatus(uid, orderId, status) {
  db.ref("orders/" + uid + "/" + orderId + "/status").set(status);
  alert("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©");
}

  </script>
</head>
<body>
  <div class="container">
    <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø¯ÙŠØ±</h2><h3>Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯ / Ù†Ù‚Ø§Ø·</h3>
<input type="text" id="uid" placeholder="Ø§Ø¯Ø®Ù„ UID Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input type="number" id="balance" placeholder="Ø±ØµÙŠØ¯ Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡">
<input type="number" id="points" placeholder="Ù†Ù‚Ø§Ø· Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§">
<button onclick="addBalancePoints()">ØªØ­Ø¯ÙŠØ«</button>

<h3>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
<table>
  <thead>
    <tr>
      <th>UID</th>
      <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
      <th>Ø§Ù„Ø­Ø³Ø§Ø¨ / ID</th>
      <th>Ø±Ù‚Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„</th>
      <th>Ø§Ù„ÙˆÙ‚Øª</th>
      <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
    </tr>
  </thead>
  <tbody id="ordersBody">
    <tr><td colspan="6">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª...</td></tr>
  </tbody>
</table>

  </div>
</body>
</html>
