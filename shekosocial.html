<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<!-- CropperJS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

<style>
body {
  font-family: Arial;
  background:#111;
  color:white;
  padding:20px;
  text-align:center;
}

input, button, select {
  padding:10px;
  margin:10px;
  border-radius:6px;
  border:none;
}

button {
  background:red;
  color:white;
  cursor:pointer;
}

.box {
  background:#222;
  padding:15px;
  border-radius:8px;
  margin-top:20px;
}

/* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Øµ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
#cropArea {
  display:none;
  margin-top:20px;
}

.crop-container {
  width: 300px;
  height: 300px;
  margin:auto;
  background:#000;
  border-radius:10px;
  overflow:hidden;
}

.crop-container img {
  max-width:100%;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
.crop-controls button {
  background:#333;
  margin:5px;
  padding:10px 12px;
}
</style>

</head>
<body>

<h2>ğŸ”¥ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â€“ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© + Ø§Ù„Ø±ÙˆØ§Ø¨Ø· + Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ ğŸ”¥</h2>

<!-- Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© -->
<div class="box">
  <h3>Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
  <input type="file" id="mainImage">
</div>

<!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Øµ -->
<div id="cropArea">
    <h3>âœ‚ Ù‚Øµ Ø§Ù„ØµÙˆØ±Ø©</h3>

    <div class="crop-container">
        <img id="imageToCrop">
    </div>

    <div class="crop-controls">
        <button onclick="cropper.zoom(0.1)">â• ØªÙƒØ¨ÙŠØ±</button>
        <button onclick="cropper.zoom(-0.1)">â– ØªØµØºÙŠØ±</button>
        <button onclick="cropper.rotate(90)">â†ª ØªØ¯ÙˆÙŠØ±</button>
        <button onclick="cropper.rotate(-90)">â†© ØªØ¯ÙˆÙŠØ±</button>
        <button onclick="resetCrop()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø©</button>
        <button onclick="uploadCroppedImage()">âœ” Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©</button>
    </div>
</div>

<!-- Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· -->
<div class="box">
  <h3>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ù„Ù„ØµÙØ­Ø©</h3>
  <input id="linkText" placeholder="Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø·">
  <input id="linkURL" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø·">
  <button onclick="addLink()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø·</button>
</div>

<!-- Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ -->
<div class="box">
  <h3>Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</h3>

  <select id="socialType">
    <option value="facebook">Facebook</option>
    <option value="instagram">Instagram</option>
    <option value="youtube">YouTube</option>
    <option value="tiktok">TikTok</option>
    <option value="twitter">Twitter</option>
    <option value="snapchat">Snapchat</option>
  </select>

  <input id="socialURL" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨">
  <button onclick="addSocial()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨</button>
</div>

<script>
/* ------------------------ Firebase ------------------------ */
const firebaseConfig = {
  apiKey: "AIzaSyAYcZ2_RjaI4fjP14QlqbUbL3rWvPPWnas",
  authDomain: "sheko-store.firebaseapp.com",
  databaseURL: "https://sheko-store-default-rtdb.firebaseio.com",
  projectId: "sheko-store",
  storageBucket: "sheko-store.appspot.com",
  messagingSenderId: "113892775847",
  appId: "1:113892775847:web:2aa4c11c3f5dd1d15f0882"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let cropper;

/* ------------------------ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© ------------------------ */
document.getElementById("mainImage").addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        const img = document.getElementById("imageToCrop");

        img.onload = function () {
            document.getElementById("cropArea").style.display = "block";

            if (cropper) cropper.destroy();

            cropper = new Cropper(img, {
                aspectRatio: 1,
                viewMode: 1,
                autoCropArea: 1,
                background: false
            });
        };

        img.src = e.target.result;
    };

    reader.readAsDataURL(file);
});

/* ------------------------ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‚Øµ ------------------------ */
function resetCrop(){
    if (cropper) cropper.reset();
}

/* ------------------------ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ ------------------------ */
function uploadCroppedImage() {
    if (!cropper) return;

    const canvas = cropper.getCroppedCanvas({
        width: 600,
        height: 600,
        fillColor: "#000"
    });

    const base64 = canvas.toDataURL("image/jpeg", 0.9);

    db.ref("mainPage/image")
      .set(base64)
      .then(() => alert("âœ” ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!"));
}

/* ------------------------ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ------------------------ */
function addLink(){
  const name = document.getElementById("linkText").value.trim();
  const url = document.getElementById("linkURL").value.trim();

  if(!name || !url){ alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø§Ø¨Ø·"); return; }

  db.ref("mainPage/links").push({ name, url });

  document.getElementById("linkText").value="";
  document.getElementById("linkURL").value="";
  alert("âœ” ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø·");
}

/* ------------------------ Ø¥Ø¶Ø§ÙØ© Ø³ÙˆØ´ÙŠØ§Ù„ ------------------------ */
function addSocial(){
  const type = document.getElementById("socialType").value;
  const url = document.getElementById("socialURL").value.trim();

  if(!url){ alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø§Ø¨Ø·"); return; }

  db.ref("mainPage/social").push({ type, url });

  document.getElementById("socialURL").value="";
  alert("âœ” ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨");
}
</script>

</body>
</html>
