<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<!-- CROP JAVASCRIPT -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

<style>
body {font-family: Arial; background:#111; color:white; padding:20px; text-align:center;}
input, button {padding:10px; margin:10px; border-radius:6px; border:none;}
button {background:red; color:white; cursor:pointer;}
.box {background:#222; padding:15px; border-radius:8px; margin-top:20px;}

#cropArea {width:300px; max-height:300px; margin:auto; display:none;}
#cropArea img {max-width:100%; border-radius:10px;}
</style>

</head>
<body>

<h2>ğŸ”¥ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â€“ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© + Ø§Ù„Ø±ÙˆØ§Ø¨Ø· + Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ ğŸ”¥</h2>

<!-- Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© -->
<div class="box">
  <h3>Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>

  <input type="file" id="mainImage" accept="image/*">

  <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Øµ -->
  <div id="cropArea">
    <img id="imageToCrop">
  </div>

  <button onclick="uploadCroppedImage()">Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</button>
</div>


<!-- Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· -->
<div class="box">
  <h3>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ù„Ù„ØµÙØ­Ø©</h3>
  <input id="linkText" placeholder="Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø·">
  <input id="linkURL" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø·">
  <button onclick="addLink()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø·</button>
</div>

<!-- Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ -->
<div class="box">
  <h3>Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</h3>

  <select id="socialType">
    <option value="facebook">Facebook</option>
    <option value="instagram">Instagram</option>
    <option value="youtube">YouTube</option>
    <option value="tiktok">TikTok</option>
    <option value="twitter">Twitter</option>
    <option value="snapchat">Snapchat</option>
  </select>

  <input id="socialURL" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨">
  <button onclick="addSocial()">Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨</button>
</div>


<script>
/* --------------------------- Firebase --------------------------- */
const firebaseConfig = {
  apiKey: "AIzaSyAYcZ2_RjaI4fjP14QlqbUbL3rWvPPWnas",
  authDomain: "sheko-store.firebaseapp.com",
  databaseURL: "https://sheko-store-default-rtdb.firebaseio.com",
  projectId: "sheko-store",
  storageBucket: "sheko-store.appspot.com",
  messagingSenderId: "113892775847",
  appId: "1:113892775847:web:2aa4c11c3f5dd1d15f0882"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ------------------------ CROP IMAGE ------------------------ */
let cropper;

document.getElementById("mainImage").addEventListener("change", function(){
  const file = this.files[0];
  if(!file) return;

  const reader = new FileReader();
  reader.onload = function(e){
    document.getElementById("cropArea").style.display = "block";
    const img = document.getElementById("imageToCrop");
    img.src = e.target.result;

    // ØªØ¯Ù…ÙŠØ± ÙƒØ±ÙˆØ¨Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯
    if(cropper){
      cropper.destroy();
    }

    cropper = new Cropper(img, {
      aspectRatio: 1,  // Ù…Ø±Ø¨Ø¹
      viewMode: 1,
      autoCropArea: 1,
      dragMode: 'move'
    });
  };
  reader.readAsDataURL(file);
});


/* ------------------------ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ ------------------------ */
function uploadCroppedImage(){
  if(!cropper){
    alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹");
    return;
  }

  const base64 = cropper.getCroppedCanvas({ width: 600, height: 600 }).toDataURL();

  db.ref("mainPage/image").set(base64)
    .then(()=> alert("âœ” ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ"))
    .catch(()=> alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸"));
}


/* ------------------------ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ------------------------ */
function addLink(){
  const name = document.getElementById("linkText").value.trim();
  const url = document.getElementById("linkURL").value.trim();

  if(!name || !url){ alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø§Ø¨Ø·"); return; }

  db.ref("mainPage/links").push({ name, url });

  document.getElementById("linkText").value="";
  document.getElementById("linkURL").value="";
  alert("âœ” ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø·");
}


/* ------------------------ Ø¥Ø¶Ø§ÙØ© Ø³ÙˆØ´ÙŠØ§Ù„ ------------------------ */
function addSocial(){
  const type = document.getElementById("socialType").value;
  const url = document.getElementById("socialURL").value.trim();

  if(!url){ alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø§Ø¨Ø·"); return; }

  db.ref("mainPage/social").push({ type, url });

  document.getElementById("socialURL").value="";
  alert("âœ” ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨");
}
</script>

</body>
</html>
